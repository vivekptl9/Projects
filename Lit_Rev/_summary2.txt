An empirical galaxy and AGN mock catalogue for the exploitation of future surveys X. LópezLópez1, 2, M. Bolzonella1, L. Pozzetti1, C. Schreiber14, and G. Zamorani1. Astronomy &Astrophysics manuscript no. main. We present MAMBO, a flexible and e fficient workflow to build empi. Current and future large surveys will produce unprecedented amounts of data. Realistic simulations have become essential for the design and development of these surveys. We start from simulated dark matter( DM) haloes, and we populate them with galaxies and AGN using abundance matching techniques. We apply the method to a Millennium DM lightcone of 3. 14 deg2up to redshift z=10 and down to stellar massesM≳107. 5M⊙. Euclid catalogue can be used to make useful predictions for large surveys. We find that Euclid might observe about 107and 8×107 Type 1 and 2 AGN respectively, and 2 ×109galaxies at the end of its 14 679 deg2Wide survey. Synthetic data reproduc- ing observed properties of astrophysical sources have become essential to enhance the scientific return from this new data. Different methods can be used to generate mock catalogues, ranging from physicsoriented models to dataoriented simulations. Largescale simulations that accurately reproduce galaxy properties have been developed. These methods not only save computation time but also ensure that results align well with most observed scaling relations. In addition, thanks to their optimised computational efficiency, they  are more efficient than traditional methods. We use a semiempirical method to produce realistic samples of synthetic galaxies and AGN. At the same time, we preserve the link with the cosmic web traced by dark matter( DM) haloes. This connection is fundamental for deriv- ing cosmological forecasts. Xray AGN photons are generated through nonthermal processes near the central black hole. They serve as an ideal tracer of AGN activity. The Xray band, especially for the brightest sources, experiences minimal contamination from the host galaxy. MAMBO MAMBO( Mocks with Abundance Matching in BOlogna) is a workflow designed to construct an empirical mock catalogue of galaxies. The catalogue can be used to make predictions for future surveys, focusing on Euclid as a representative case. A detailed description of the method- ology and a validation of the galaxy properties can be found in Girelli( 2021) and is briefly summarised in this section. In the rest of this paper, instead, we will focus our attention on the inclusion of AGN into this workflow. with accuracy their physical prop- erties and observables. MAMBO takes in input few quantities from cosmological Nbody DM simulations. The DM halo mass is expressed as Article number, page 2 of 22X. LópezLópez et al. create the galaxy and AGN mock catalogue. They use a modified version of the public code EGG. MAMBO is an empirical galaxy and AGN mock catalogue for the exploitation of future surveys M2001for main haloes and Minfall2for subhaloes and orphans3; the redshift zof each halo and subhalo. The sky coordinates RA and Dec are not used as inputs, but are needed to reconstruct the cosmic web. The mock galaxy system is based on stellar mass functions (SMFs) on the SDSS, COSMOS and CANDELS fields. SMFs are classified by relative ratio of the blue and red populations in ob- served SMFs. Every galaxy in the mock is classified as pas- sive/quiescent( Q) or starforming( SF) in a probabilistic way. The starforming fraction was ex- trapolated from the results at lower redshifts, arriving at a max- imum of fSF=99% at z=6. This choice is motivated by the fact that at that red- shift, the Universe is supposed to be too young. We plan to revise these assumptions once su fficient data becomes available to accurately constrain the s. We show in Fig. 2 the stellar mass and redshift distributions resulting from applying the SHMR and the SF /Q classification process described above. As it is visible from this figure, the galaxy catalogue is complete at least down to M∼ 107. 5M⊙, which is a consequence of the mass completeness of the DM halo catalogue. Emmirical Galaxy Generator (EGG) is a C ++code designed to generate an empirical mock catalogue of galaxies with realistic physical properties. The code has been calibrated purely by using empirical relations to produce realistic observable properties. In order to assign a SED( spectral energy distribution) to each galaxy, EGG selects a two component system. EGG can take as an input the stellar mass M, red- shift z, and type( starforming or quiescent) of each galaxy. It can produce these quantities randomly extracting zandMfrom the observed galaxy SMFs. Gaussian emission lines with a given velocity dispersion4is assigned to the SEDs of the bulge and the disc components. Methodology adopted to populate our galaxy catalogue with AGN. Full MAMBO workflow can be applied to any DM simulation. Method pre- sented in Sect. 3 to populate galaxies withAGN can be apply to any mock galaxy catalogue containing information about galaxy stellar mass. We modified the original recipe in EGG with a massdependent σgas from Bezanson et al. ( 2018) . Article number, page 3 of 22A&A proofs: manuscript no. main Fig. 2. Distribution of stellar mass and redshift of all the galaxies in the MAMBO lightcone used in this work. In the following subsections, we use two specific accretion rate distribution functions( SARDFs) with di fferent definitions. LXandFX refer, respectively, to the intrinsic luminosity and observed flux in the hard( [2 −10keV] Xray band. An AGN accreting at 1% of the Eddington limit would have. λsBHAR∼10−2. We note that both in Bongiorno et. ( 2016) and in Aird et al. ( 2018) this was set as the lower limit to define a galaxy as hosting an AGN. In B16 the authors studied a sample of 877 hard( 2−10 keV) Xray selected AGN from the XMMCOSMOS pointlike source catalogue. B16 corrected for the stellar mass incompleteness of the sample down to the abovementioned limit in λSAR. This was done considering column density values in the range 20<logNH/cm−2<24, and therefore not including Compton- thick AGN. Although a significant fraction of AGN are expected to be CTK sources, their exact fraction is still a matter of debate. It is worth noting that the choice of a minimum value of λSAR sets the definition of AGN used in this work. In general, di fferent criteria can be used to select AGN based on their Xray emission. The HGMF cannot be expressed as a simple analytic function, but instead, the authors provide an analytic approxi- mation by performing a leastsquares fit. The bestfit parameters of this fit are given in Table 2 of B16. 6 The original slope( α) from the Schechter function in the first two redshift bins would produce an   reversal of-square. We rederived these quantities by fitting the 1 /Vmaxpoints shown in B16 with a Schechter function using Eq. 2. We then calculate p( AGN|M, z) as the ratio between the SMF of the galaxies of the MAMBO lightcone and the HGMF from B16. For the highest redshift bin, our fit was compati- ble with the value shown in Table 2 of B16 so we didn’t modify it. Every galaxy is statistically assigned as hosting an AGN or not with a Bernoulli trial proportional to p( AGN) The choice of a minimal fraction of 1% at z∼0 for all masses is a rough approximation. At z>2 we chose to have a constant AGN fraction. Despite being a rough approximation, with this choice we are able to reproduce the observed Xray luminosity functions up to z=7. We also show the bestfit Schechter function to the host galaxy mass function( HGMF) of AGN from Bongiorno et al. ( 2016) Black dots with errorbars show the AGN mass function computed using the Vmaxmethod, derived in B16. Lower panels: AGN fraction derived as the ratio of the modified Schechter function and the galaxy mass function from MAMBO. Fig. 3 shows the fraction of AGN over the galaxy population as a function of stellar mass and at a given redshift bin, p( AGN|M, ⟨z⟩) . As ex- pected, this fraction increases with increasing stellar mass of the host galaxy. We show in Fig. 4 the probability of a given galaxy to be hosting an AGN and in di fferent mass bins for the full lightcone. Fig. 4. Probability of a galaxy hosting an AGN as a function of red- shift. Each point corresponds to a galaxy in the MAMBO lightcone, colourcoded in di fferentMbins. For com- parison, the points with errorbars connected by dashed lines show the AGN fraction derived in A18. SARDF cannot be expressed as a simple analytic function of Mandz. Instead, we used an analytic approximation of the SARDF( evaluated at the centre of three redshift bins) The bestfit values of the normali- sation are given in Table 3 of B16. We divide the AGN in our lightcone into 5 mass bins, each of them centred at one of the abovementioned Mand all of them of width 0. 5 dex in M. We assign to each AGN a value of λSARby randomly extracting values from the corresponding PDF at each Mandzbin. At higher redshifts( z>2) , we make use of the accretion rate distributions from A18, who studied a sample of 1, 797 Xray Chandra counterparts. Using the B16 accretion rate distributions, we assign a value ofλsBHAR to each object previously labeled as AGN at z>2. After assigning every AGN in the lightcone with a specific accretion rates, we convert this into intrinsic Xray luminosity( in the 2−10 keV band) We sho sho used the accretion Rate distributions from A18 to assign LXat all redshifts. Fig. 6 shows the histogram of the assigned LXin different redshift bins for the entire population of AGN. In Fig. 7 we show the distribution of the AGN in our mock in the LX−M plane. As expected by construction, all the all the galaxy mock probes low stellar masses. Xray luminosity( LX) of all the AGN in the lightcone, separated into Type 1( blue) and Type 2( or- ange) AGN, in di fferent redshift bins. We also show with dashed and solid lines the subpopulations of Type 1 and 2 in star forming and qui- escent galaxies.  AGN display a much wider observational variety which allows us to classify them in many other sub- classes. Such classification is beyond the scope of this work. In order to separate the AGN of our catalogue into opti- cally obscured and unobscured, we make use of the results pre- sented in Merloni et al. ( 2014) We show also the distribution of sources from the Chandra COSMOS Legacy Spectral Survey. The contour levels repre- sent isodensity lines, corresponding to the 50th, 75th, 90th, and 99th percentiles of the distribution. The Xray emission from AGN( especially in the soft band) can be heavily obscured by gas and dust. To quantify this e ffect, we assign to each AGN a value of absorption column density( NH) This allows us to classify the AGN in our catalogue as Xray Type 1 and Type 2. The aim of this work is to produce a cat- alogue to be used in optical /NIR surveys. In the following sections we will focus on Type 1 AGN defined as optically unobscured sources, regardless of their Xray obscu- ration. In Fig. 6 we show the LXdistribution separated into Type 1 and Type 2 AGN. In Fig. 7 we show also the distribution of sources from the Chandra COSMOS Legacy Spectral Survey in the LX−M plane. It is visible from this figure that most of the AGN with LX<1042erg s−1are classified as Type 2 in our catalogue. With this flux cut, our AGN and the COSMOS AGN are limited to z≲3. 5. MAMBO Type 1 AGN seem to cover a narrower range in stellar mass than the CosMOS ones. We also show the fraction of objects that are obscured both in optical and Xray. In EGG, each galaxy is represented as a twocomponent composed of a disc and a bulge. Each galaxy is associated with a distinct SED, selected from a predefined lookup table. The choice of the galaxy SED is based on specific recipes tied to three main galaxy properties: its total stellar mass, its redshift, and its type. In order to construct the SEDs of Type 1 AGN in the lightcone, we made use of the parametric model developed by Temple et al. ( 2021) This model allows for the generation of synthetic quasar S EDs over the restframe wavelength range 912Å to 3 µm. These synthetic SED's have been shown to accurately reproduce, to a high degree of accuracy, the observedframe optical and near- infrared colours of quasars. Model from Temple et al. ( 2021) incorporates a single parameter( emline_type) that allows for the generation of spec- tra with di fferent emission line properties. For each Type 1 AGN, we modified the code EGG to select a SED from the prebuilt library of QSO SEDs following Eq. 5. López et al. : MAMBO - An empirical galaxy and AGN mock catalogue for the exploitation of future surveys. The proxies for the UV and Xray emissions correspond to the monochromatic restframe 2500Å and 2 keV luminosities. The E( B−V) of each source is chosen randomly from the distribution presented in Fig. 2 of Lusso et al. ( 2013) The extinction curve is similar to that of the Small Magellanic Cloud for λ⪆1700Å. To quantify how much each Type 1 AGN is dominated by the hostgalaxy stellar light or by the nuclear emission, we derived the quantity fAGN. N=0. 5 corresponds to the limit where both the galactic and the nuclear components contribute equally to that specific band. For objects flagged as Type 2 AGN, typical narrow emission lines from AGN are added to the SED of the bulge component of the host galaxy. Fig. 9. Some examples of SEDs of AGN from our lightcone. We show three representative cases: in the upper panel, we show a Type 1 AGN with dominant QSO component in the restframe UV band. The lower panel shows a Type 2 AGN, with a zoomin subpanel showing the H βand the [O iii]λλ5007, 4959 doublet emission lines. The gasphase oxygen abundance is chosen randomly in the range 8. 7<log( O/H) +12<9. 3. The fact that we are using only models with solar or supersolar metallicities for the NLR of Type 2 AGN is motivated by the fact that these are the models which best sample the region covered by local Seyfert galaxies. The ionising spectrum used in the C loudy models to represent the accretion disc of the AGN has the shape Sν∝να for the wavelength range 0. 001/µm to 0. 25. We used only models with either α=−1. 4 orα= −1. 7, randomly chosen, which sample the centre of the range modelled by Feltre et al. ( 2016) These values are also consistent with those found in local AGN from observations. The redshift evolution of AGN narrowline ratios is purely linked to that of log U. Hydrogen number density n H, i. e. volumeaveraged hy- drogen density of the narrowline region. Dustto-metal mass ratio, which accounts for the deple- tion of metals onto dust grains in the ionised gas. The emission lines of type 2 AGN are characterised by ve- locity dispersions which are higher than those of SF galaxies. The intensity of the lines is scaled to the accretion luminosity Laccof the AGN, that is, the luminosity due to accretion onto the central black hole. To model this, we used the results from Menzel et al. ( 2016) who studied the spectroscopic properties of a sample 2578 X- ray selected AGN in the redshift range z=[0. 02, 5. 0]. We modelled the FWHM distribution of the H βemission line as a log- normal distribution centred at 355 km s−1. We assigned randomly the ve- locity of dispersion of type 2 AGN following this distribution. The full list of narrowregion lines added to the spectra of Type 2 AGN is reported in Tab. 2. We show in Fig. 9 an example of Type2 AGN with these lines. The inclusion of such AGN component is left to future work. The AGN host galaxy mass function that we used to calibrate the fraction of AGN over the total galaxy population at z<2( Bon- giorno et al. 2016) is defined for z>0. 30 andM>109. 5M⊙. elengths are given in vacuum, in units of Å. For all redshift bins the fractions are roughly consistent within their uncertainities. We note that the exact AGN fraction at these low stellar mass and redshift regimes is still a matter of debate, and therefore the predictions from our catalogue should be taken with caution. We used two main observables, the Xray luminosity function and theFXcumulative number counts. These comparisons are relevant since they give hints about the purity and completeness of our catalogue in comparison to other Xray selected catalogues. The error bars of the MAMBO AGN fraction show the Poissonian uncertainty. The XLF from our mock and the observed ones at all redshift bins is in general an agreement. In Fig. 12 we show the cumulative num- ber counts of objects above a given Xray flux. This factor was chosen because Buchner et al. ( 2015) found a constant fraction of CTK objects over the total AGN population. Diagrams are a frequently utilised tool for identifying AGN. By comparing the ratios of various emission lines, we can gain insight into whether star formation, AGN or a composite of both processes dominate in the spectra of a given galaxy. In this section, we employ various optical nebular line diagnostics in order to validate the AGN on our catalogue. Fig. 13 is an example of such a diagram for the ob- jects of our catalogue, selected with z≤0. 8. This would be the maximum redshift up to which is safe to use the BPT diagram to separate SF galaxies from AGN. For clarity of visualisation, we show only galaxies and AGN selected with observed magnitude mH<24. In our mock, the emission line flux in Type 2 AGN is directly pro- portional to LX, and therefore this ratio is also correlated to LX. We also show as comparison the observed line ratios from lo- cal galaxies from the SDSS catalogue. In general, the simulated AGN from our mock fall in the regions that cor- respond to AGNdominated or composite objects. The MassExcitation( MEx) diagram( Juneau et al. 2011) was calibrated to separated starforming galaxies from AGN at 0. 3<z<1. 0. Fig. 14 shows the MEx diagram for the lighcone presented in this work, where both galaxies and AGN have been selected. The limit in magnitude allows for a better comparison with the work from Juneau and co. ( 2011) as it removes the low stellar mass tail of our catalogue. An important validation for the catalogue if we intend to repro- duce the observed AGN population is the luminosity function. In this section we study the redshift evolution of the AGN UV lu- minosity function( UVLF) at restframe wavelength λ=1450Å.